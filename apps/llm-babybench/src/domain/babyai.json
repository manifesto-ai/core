{"id":"mel:babyai","version":"1.0.0","types":{"CarriedObject":{"name":"CarriedObject","definition":{"kind":"object","fields":{"kind":{"type":{"kind":"primitive","type":"string"},"optional":false},"color":{"type":{"kind":"primitive","type":"string"},"optional":false}}}},"WorldObject":{"name":"WorldObject","definition":{"kind":"object","fields":{"id":{"type":{"kind":"primitive","type":"string"},"optional":false},"kind":{"type":{"kind":"primitive","type":"string"},"optional":false},"color":{"type":{"kind":"primitive","type":"string"},"optional":false},"x":{"type":{"kind":"primitive","type":"number"},"optional":false},"y":{"type":{"kind":"primitive","type":"number"},"optional":false},"isOpen":{"type":{"kind":"union","types":[{"kind":"primitive","type":"boolean"},{"kind":"literal","value":null}]},"optional":false}}}},"Agent":{"name":"Agent","definition":{"kind":"object","fields":{"x":{"type":{"kind":"primitive","type":"number"},"optional":false},"y":{"type":{"kind":"primitive","type":"number"},"optional":false},"direction":{"type":{"kind":"primitive","type":"number"},"optional":false},"carrying":{"type":{"kind":"union","types":[{"kind":"ref","name":"CarriedObject"},{"kind":"literal","value":null}]},"optional":false}}}},"Grid":{"name":"Grid","definition":{"kind":"object","fields":{"width":{"type":{"kind":"primitive","type":"number"},"optional":false},"height":{"type":{"kind":"primitive","type":"number"},"optional":false},"cells":{"type":{"kind":"array","element":{"kind":"array","element":{"kind":"primitive","type":"string"}}},"optional":false}}}}},"state":{"fields":{"grid":{"type":"object","required":true,"fields":{"width":{"type":"number","required":true},"height":{"type":"number","required":true},"cells":{"type":"array","required":true,"items":{"type":"array","required":true,"items":{"type":"string","required":true}}}},"default":{"width":8,"height":8,"cells":[]}},"agent":{"type":"object","required":true,"fields":{"x":{"type":"number","required":true},"y":{"type":"number","required":true},"direction":{"type":"number","required":true},"carrying":{"type":"object","required":true,"fields":{"kind":{"type":"string","required":true},"color":{"type":"string","required":true}}}},"default":{"x":0,"y":0,"direction":0,"carrying":null}},"objects":{"type":"array","required":true,"items":{"type":"object","required":true,"fields":{"id":{"type":"string","required":true},"kind":{"type":"string","required":true},"color":{"type":"string","required":true},"x":{"type":"number","required":true},"y":{"type":"number","required":true},"isOpen":{"type":"boolean","required":true}}},"default":[]},"mission":{"type":"string","required":true,"default":""},"steps":{"type":"number","required":true,"default":0},"maxSteps":{"type":"number","required":true,"default":100},"goalReached":{"type":"boolean","required":true,"default":false},"lastMoveIntent":{"type":"string","required":true,"default":null},"lastPickupIntent":{"type":"string","required":true,"default":null},"lastDropIntent":{"type":"string","required":true,"default":null},"lastToggleIntent":{"type":"string","required":true,"default":null}}},"computed":{"fields":{"computed.canPickup":{"deps":["agent.carrying"],"expr":{"kind":"isNull","arg":{"kind":"get","path":"agent.carrying"}}},"computed.canDrop":{"deps":["agent.carrying"],"expr":{"kind":"not","arg":{"kind":"isNull","arg":{"kind":"get","path":"agent.carrying"}}}},"computed.stepsRemaining":{"deps":["maxSteps","steps"],"expr":{"kind":"sub","left":{"kind":"get","path":"maxSteps"},"right":{"kind":"get","path":"steps"}}},"computed.isAtLimit":{"deps":["steps","maxSteps"],"expr":{"kind":"gte","left":{"kind":"get","path":"steps"},"right":{"kind":"get","path":"maxSteps"}}}}},"actions":{"turnLeft":{"flow":{"kind":"if","cond":{"kind":"not","arg":{"kind":"get","path":"goalReached"}},"then":{"kind":"seq","steps":[{"kind":"patch","op":"set","path":"agent.direction","value":{"kind":"mod","left":{"kind":"add","left":{"kind":"get","path":"agent.direction"},"right":{"kind":"lit","value":3}},"right":{"kind":"lit","value":4}}},{"kind":"patch","op":"set","path":"steps","value":{"kind":"add","left":{"kind":"get","path":"steps"},"right":{"kind":"lit","value":1}}}]}}},"turnRight":{"flow":{"kind":"if","cond":{"kind":"not","arg":{"kind":"get","path":"goalReached"}},"then":{"kind":"seq","steps":[{"kind":"patch","op":"set","path":"agent.direction","value":{"kind":"mod","left":{"kind":"add","left":{"kind":"get","path":"agent.direction"},"right":{"kind":"lit","value":1}},"right":{"kind":"lit","value":4}}},{"kind":"patch","op":"set","path":"steps","value":{"kind":"add","left":{"kind":"get","path":"steps"},"right":{"kind":"lit","value":1}}}]}}},"moveForward":{"flow":{"kind":"if","cond":{"kind":"and","args":[{"kind":"neq","left":{"kind":"get","path":"lastMoveIntent"},"right":{"kind":"get","path":"meta.intentId"}},{"kind":"not","arg":{"kind":"get","path":"goalReached"}}]},"then":{"kind":"seq","steps":[{"kind":"patch","op":"set","path":"lastMoveIntent","value":{"kind":"get","path":"meta.intentId"}},{"kind":"patch","op":"set","path":"lastMoveIntent","value":{"kind":"get","path":"meta.intentId"}},{"kind":"effect","type":"babyai.move","params":{"x":{"kind":"get","path":"agent.x"},"y":{"kind":"get","path":"agent.y"},"direction":{"kind":"get","path":"agent.direction"}}}]}}},"pickup":{"flow":{"kind":"if","cond":{"kind":"and","args":[{"kind":"neq","left":{"kind":"get","path":"lastPickupIntent"},"right":{"kind":"get","path":"meta.intentId"}},{"kind":"not","arg":{"kind":"get","path":"goalReached"}}]},"then":{"kind":"seq","steps":[{"kind":"patch","op":"set","path":"lastPickupIntent","value":{"kind":"get","path":"meta.intentId"}},{"kind":"patch","op":"set","path":"lastPickupIntent","value":{"kind":"get","path":"meta.intentId"}},{"kind":"effect","type":"babyai.pickup","params":{"x":{"kind":"get","path":"agent.x"},"y":{"kind":"get","path":"agent.y"},"direction":{"kind":"get","path":"agent.direction"}}}]}},"available":{"kind":"get","path":"computed.canPickup"}},"drop":{"flow":{"kind":"if","cond":{"kind":"and","args":[{"kind":"neq","left":{"kind":"get","path":"lastDropIntent"},"right":{"kind":"get","path":"meta.intentId"}},{"kind":"not","arg":{"kind":"get","path":"goalReached"}}]},"then":{"kind":"seq","steps":[{"kind":"patch","op":"set","path":"lastDropIntent","value":{"kind":"get","path":"meta.intentId"}},{"kind":"patch","op":"set","path":"lastDropIntent","value":{"kind":"get","path":"meta.intentId"}},{"kind":"effect","type":"babyai.drop","params":{"x":{"kind":"get","path":"agent.x"},"y":{"kind":"get","path":"agent.y"},"direction":{"kind":"get","path":"agent.direction"},"carrying":{"kind":"get","path":"agent.carrying"}}}]}},"available":{"kind":"get","path":"computed.canDrop"}},"toggle":{"flow":{"kind":"if","cond":{"kind":"and","args":[{"kind":"neq","left":{"kind":"get","path":"lastToggleIntent"},"right":{"kind":"get","path":"meta.intentId"}},{"kind":"not","arg":{"kind":"get","path":"goalReached"}}]},"then":{"kind":"seq","steps":[{"kind":"patch","op":"set","path":"lastToggleIntent","value":{"kind":"get","path":"meta.intentId"}},{"kind":"patch","op":"set","path":"lastToggleIntent","value":{"kind":"get","path":"meta.intentId"}},{"kind":"effect","type":"babyai.toggle","params":{"x":{"kind":"get","path":"agent.x"},"y":{"kind":"get","path":"agent.y"},"direction":{"kind":"get","path":"agent.direction"}}}]}}},"done":{"flow":{"kind":"if","cond":{"kind":"not","arg":{"kind":"get","path":"goalReached"}},"then":{"kind":"patch","op":"set","path":"goalReached","value":{"kind":"lit","value":true}}}}},"meta":{"name":"BabyAI"},"hash":"603e29342d1b7ca8e62ff6b0d05d433a62187b4079cf3032d5a09ee8e27b1227"}